# 测试评论功能

## 测试步骤

1. **启动服务器**
   ```bash
   # 终端 1: 启动 WebSocket 服务器
   npm run server
   
   # 终端 2: 启动开发服务器
   npm run dev
   ```

2. **测试单用户评论**
   - 打开 http://localhost:5173
   - 选中文本 "欢迎使用 Tiptap 协作编辑器"
   - 点击工具栏 "💬 评论" 按钮
   - 在右侧面板输入 "这是一条测试评论"
   - 验证评论是否显示
   - 点击评论查看是否能激活和编辑

3. **测试多用户协同**
   - 打开两个浏览器标签页
   - 标签页 A: 选中文本并添加评论 "来自用户A的评论"
   - 标签页 B: 验证是否实时看到评论
   - 标签页 B: 在该评论下添加回复 "来自用户B的回复"
   - 标签页 A: 验证是否实时看到回复

4. **测试评论定位**
   - 在编辑器中向下滚动
   - 在评论面板点击 📍 按钮
   - 验证是否自动滚动并选中对应文本

5. **测试评论删除**
   - 点击评论的 🗑️ 按钮
   - 确认删除
   - 验证评论和文本标记都被移除
   - 在另一标签页验证删除是否同步

6. **测试快捷键**
   - 选中文本
   - 按 Ctrl+Shift+M (Mac: Cmd+Shift+M)
   - 验证评论是否创建并激活

## 预期结果

- ✅ 评论能正确创建和显示
- ✅ 评论内容实时同步到所有客户端
- ✅ 回复功能正常工作
- ✅ 评论定位功能准确
- ✅ 删除操作同步到所有客户端
- ✅ 快捷键正常工作
- ✅ 评论面板可折叠展开
- ✅ 评论标记在文本上正确显示

## 常见问题排查

### 评论不显示
- 检查浏览器控制台是否有错误
- 验证 WebSocket 连接状态
- 刷新页面重试

### 评论不同步
- 确认 WebSocket 服务器正在运行
- 检查网络连接
- 查看服务器日志

### 样式问题
- 清除浏览器缓存
- 确认 CSS 文件已加载
- 检查浏览器兼容性

## 性能测试

1. **大量评论**
   - 添加 50+ 条评论
   - 验证性能是否流畅
   - 检查内存占用

2. **长文档**
   - 创建包含多个段落的长文档
   - 在不同位置添加评论
   - 验证滚动和定位性能

3. **多用户并发**
   - 同时在 5+ 个标签页中操作
   - 验证同步速度和准确性
   - 检查是否有冲突

## 成功标准

- 所有基本功能正常工作
- 多用户协同无冲突
- 界面响应流畅
- 数据同步延迟 < 500ms
- 无 JavaScript 错误
- 无内存泄漏

---

测试完成后,请在 GitHub Issues 中报告任何问题!
